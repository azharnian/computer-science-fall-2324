!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5c3dfca1-b750-4028-b7ab-786680b72d35",e._sentryDebugIdIdentifier="sentry-dbid-5c3dfca1-b750-4028-b7ab-786680b72d35")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"468e0ce18ce8eaa072d85361b0e2c2d814ed5dca"},(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"593+":function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("SVse"),a=r("8Y7J");let i=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Yb({type:e}),e.\u0275inj=a.Xb({imports:[[n.c]]}),e})()},"7/GS":function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("5SZk"),a=r("8Y7J");let i=(()=>{class e{transform(e,t){return Object(n.d)(e,{grey:"default",whoBlue:"new-pin-who-blue",green:"new-pin-green",yellow:"new-pin-yellow",orange:"new-pin-orange",red:"new-pin-red",purple:"new-pin-purple",maroon:"new-pin-maroon"},t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=a.Zb({name:"pm25MapPinClass",type:e,pure:!0}),e})()},AuMg:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r("g8r5"),a=r("jV2t"),i=r("5SZk"),s=r("8Y7J");let o=(()=>{class e{transform(e,t){return Object(i.d)(e,{whoBlue:"0",green:"1",yellow:"2",orange:"3",red:"4",purple:"5",maroon:"6"},t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Zb({name:"pm25ClusterIcon",type:e,pure:!0}),e})();var l=r("7/GS"),c=r("mov8"),u=function(e){return e.STATION="station",e.CLUSTER="cluster",e}({}),p=r("KUxh"),d=r("BIJc"),m=r("aWBA"),h=r("OQrI");let f=(()=>{class e{constructor(e,t,r,i){this.leafletBuilder=e,this.placesMarkerService=t,this.placesSelectionService=r,this.zoomService=i,this.Pm25ClusterIconPipe=new o,this.Pm25MapPinClassPipe=new l.a,this.AqiFgBgColorClassPipe=new n.a,this.AqiMapPinColorClassPipe=new a.a,this._maxClusterRadius=e=>e==c.c?0:e>c.e?20:10}createPlaceLayer(e,t,r=null,n,a){const i=null==n?void 0:n.getZoom(),s=this._buildClusterGroupOptions(e,i,a),o=this.createAqiMarkers(e,t,r,a,i);return this.createMarkerClusterGroup(e,s).addLayers(o)}createPlacesLayerFromClusteredMarkers(e,t,r=null,n,a){const i=n.getZoom(),s=t.map(t=>t.type===u.CLUSTER?this._buildClusterMarker(e,t,a,i,n):t.type===u.STATION?this._buildOsmMarkerAndHandleSelection(e,t,i,a,r):void 0);return this.leafletBuilder.createLayerGroup(e,s)}_buildClusterMarker(e,t,r,n,a){return this.leafletBuilder.createMarker(e,t.coordinates,{icon:this._buildClusterIcon(e,r.isUNEP?t.concentration:t.aqi,n,r),aqiMarker:t}).on("click",e=>{const{lat:t,lng:r}=e.latlng;t&&r&&this.zoomService.zoomTo(a,t,r,n+2)})}_buildClusterGroupOptions(e,t,r){return{maxClusterRadius:e=>this._maxClusterRadius(e),showCoverageOnHover:!1,iconCreateFunction:n=>this._frontendClusterIconCreateFn(e,n,r,t),chunkedLoading:!0,chunkDelay:20}}_frontendClusterIconCreateFn(e,t,r,n){const a=this.leafletBuilder.getClusterChildMarkers(t).map(e=>e.options.value),i=Math.round(a.reduce((e,t)=>e+t)/a.length);return this._buildClusterIcon(e,i,n,r)}_buildClusterIcon(e,t,r,n){const a=Math.ceil(t);let i="",s="";if(n.isUNEP){const e=!0;i=this.Pm25ClusterIconPipe.transform(a,{useRankingColorRange:e}),s=this.Pm25MapPinClassPipe.transform(a,{useRankingColorRange:e})}else i=this.AqiFgBgColorClassPipe.getClusterIcon(a),s=this.AqiMapPinColorClassPipe.transform(a);return!n.disableSmallPin&&r<=c.e&&(s+=" map-cluster-small"),this.leafletBuilder.createDivIcon(e,{iconSize:[0,0],html:`<div aria-label="AQI Cluster, Average AQI Value: ${a}" class="map-cluster ${s}" style="background: url(assets/img/map-clusterer/c${i}.svg); background-size: contain;">${a}</div>`})}createMarkerClusterGroup(e,t){return this.leafletBuilder.createMarkerClusterGroup(e,t)}createAqiMarkers(e,t,r=null,n,a=null){return t.map(t=>this._buildOsmMarkerAndHandleSelection(e,t,a,n,r))}_buildOsmMarkerAndHandleSelection(e,t,r,n,a){const i=this.placesSelectionService.placeIsSelected(t),s=this._buildMarker(e,t,i,n,r,a);return i&&this.placesSelectionService.updateSelectedPlace(s),s}_buildMarker(e,t,r,n,a,i){const s=this.placesMarkerService.getOsmPinProperties(t,n.isUNEP,n.disableSmallPin,a),o=this.placesMarkerService.getMarkerIcon(e,r,t,n,a);return this.leafletBuilder.createMarker(e,t.coordinates,{id:t.id,icon:o,value:s.displayValue,keyboard:!0,aqiMarker:t}).on("click",r=>{this.placesSelectionService.selectPlace(e,r.target,a,n),i&&i(r,t)})}}return e.\u0275fac=function(t){return new(t||e)(s.kc(p.a),s.kc(d.a),s.kc(m.a),s.kc(h.a))},e.\u0275prov=s.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},BIJc:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var n=r("jV2t"),a=r("7/GS"),i=r("mov8"),s=r("8Y7J"),o=r("KUxh");let l=(()=>{class e{constructor(e){this.leafletHelper=e,this.pm25MapPinClassPipe=new a.a,this.aqiMapPinColorClassPipe=new n.a}getMarkerHTML(e,t){let{className:r,displayValue:n,itemAlt:a}=t;r=r.trim();const s=r.replace("new-pin-","").replace(`${i.b} `,"").trim();return e?`<div aria-label="${a}" class="map-pin selected-pin ${r}-pin bg-${s}-pin">${n}</div>`:`<div aria-label="${a}" class="map-pin ${r}">${n}</div>`}getMarkerIcon(e,t,r,n,a){const i=this.getOsmPinProperties(r,n.isUNEP,n.disableSmallPin,a);return t?this._createSelectedIcon(e,i):this._createUnselectedIcon(e,i)}_createUnselectedIcon(e,t){return this.leafletHelper.createDivIcon(e,{iconSize:[0,0],html:this.getMarkerHTML(!1,t)})}_createSelectedIcon(e,t){return this.leafletHelper.createDivIcon(e,{iconSize:[0,0],html:this.getMarkerHTML(!0,t)})}getOsmPinProperties(e,t,r,n){const a=this._appendSmallPinClass(r,n);return t?this._propUnepPin(e,a):this._propNormalPin(e,a)}_appendSmallPinClass(e,t){return e||t>i.e?"":`${i.b} `}_propUnepPin(e,t){const r=`${t}${this.pm25MapPinClassPipe.transform(e.concentration,{useRankingColorRange:!0})}`,n=Math.round(e.concentration||0);return{className:r,displayValue:n,itemAlt:`${e.name}, PM2.5 Value: ${n}`}}_propNormalPin(e,t){const r=`${t}${this.aqiMapPinColorClassPipe.transform(e.aqi)}`,n=Math.round(e.aqi||0);return{className:r,displayValue:n,itemAlt:`${e.name}, AQI Value: ${n}`}}}return e.\u0275fac=function(t){return new(t||e)(s.kc(o.a))},e.\u0275prov=s.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},KUxh:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return i});var n=r("8Y7J");let a=(()=>{class e{constructor(){}createMarkerClusterGroup(e,t){return new e.markerClusterGroup(t)}createMarker(e,t,r){const n=e.latLng(t.latitude,t.longitude);return new e.marker(n,r)}getClusterChildMarkers(e){return e.getAllChildMarkers()}createDivIcon(e,t){return e.divIcon(t)}getMarkerFromCluster(e,t){let r;if(null==e||e.eachLayer(e=>{e.options.id===t&&(r=e)}),!r)throw new i(t);return r}createLayerGroup(e,t){return e.layerGroup(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class i extends Error{constructor(e){super(),this.message=`OsmMarkerNotFoundError : Could not find marker ${e} in map`}}},OQrI:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("mrSG"),a=r("8Y7J");let i=(()=>{class e{constructor(){}zoomIn(e){e.setZoom(e.getZoom()+1)}zoomOut(e){e.setZoom(e.getZoom()-1)}setZoom(e,t){e.setZoom(t)}zoomTo(e,t,r,n=15){e.setView([t,r],n)}getZoom(e){return e.getZoom()}zoomToShowMarker(e,t,r){return Object(n.a)(this,void 0,void 0,function*(){return new Promise((n,a)=>{try{t.zoomToShowLayer(r,()=>{const t=e.getZoom(),{lat:a,lng:i}=r.getLatLng();this.zoomTo(e,a,i,t),n()})}catch(i){a(i)}})})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},aWBA:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r("8Y7J"),a=r("BIJc"),i=r("iInd");let s=(()=>{class e{constructor(e,t){this.placesMarkerService=e,this.activatedRoute=t,this.placeIsSelected=e=>{var t,r;const n=(null===(r=null===(t=this._selectedMarker)||void 0===t?void 0:t.options)||void 0===r?void 0:r.id)||this.activatedRoute.snapshot.queryParamMap.get("placeId");return e.id===n}}selectPlace(e,t,r,n){this._selectedMarker&&this._updateMarkerIcon(e,this._selectedMarker,!1,r,n),this._updateMarkerIcon(e,t,!0,r,n),this.updateSelectedPlace(t)}_updateMarkerIcon(e,t,r,n,a){const i=this.placesMarkerService.getMarkerIcon(e,r,t.options.aqiMarker,a,n);t.setIcon(i)}updateSelectedPlace(e){this._selectedMarker=e}}return e.\u0275fac=function(t){return new(t||e)(n.kc(a.a),n.kc(i.a))},e.\u0275prov=n.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},hjD9:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var n=r("SVse"),a=r("8Y7J"),i=r("BPAf");const s=["mapDiv"],o=["*"];let l=(()=>{class e{constructor(e,t){this.platformId=e,this.userPref=t,this.mapOptions={zoom:3,minZoom:3,maxZoom:15,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:[[-85,-180],[85,180]],tap:!1},this.center=[11.89735,.852629],this.mapLoaded=new a.r,this.mapMoveStart=new a.r,this.mapMoveEnd=new a.r,this.mapResize=new a.r,this.mapClicked=new a.r,this.defaultLatLng=[51.505,-.09]}ngOnInit(){var e;2!==(null===(e=this.center)||void 0===e?void 0:e.length)&&this.setDefaultLatLng()}setDefaultLatLng(){if(Object(n.B)(this.platformId))try{const e=this.userPref.coordinates;this.center=[e.latitude,e.longitude]}catch(e){this.center=this.defaultLatLng}}ngAfterViewInit(){Object(n.B)(this.platformId)&&this.loadLeafletModules().then(e=>{const t=e.map(this.mapDiv.nativeElement,Object.assign({gestureHandling:!0},this.mapOptions));t.on("load",()=>this.mapLoaded.emit({L:e,mapObj:t,mapDiv:this.mapDiv})).on("movestart",()=>this.mapMoveStart.emit()).on("moveend",()=>this.mapMoveEnd.emit()).on("resize",()=>this.mapResize.emit()).on("click",e=>this.mapClicked.emit(e)).setView(this.center),!1!==this.mapOptions.dragging&&t.dragging.enable()})}loadLeafletModules(){return r.e(25).then(r.t.bind(null,"4R65",7)).then(e=>{const t=e.default;return Promise.all([r.e(25),r.e(195)]).then(r.t.bind(null,"9srS",7)).then(e=>r.e(193).then(r.t.bind(null,"JXP8",7)).then(e=>r.e(192).then(r.t.bind(null,"+2bi",7)).then(r=>(t.Map.addInitHook("addHandler","gestureHandling",r.default),Promise.resolve(Object.assign({},t,e.default))))))})}}return e.\u0275fac=function(t){return new(t||e)(a.ac(a.J),a.ac(i.b))},e.\u0275cmp=a.Ub({type:e,selectors:[["app-osm-core"]],viewQuery:function(e,t){if(1&e&&a.md(s,1),2&e){let e;a.Nc(e=a.pc())&&(t.mapDiv=e.first)}},inputs:{mapOptions:"mapOptions",center:"center"},outputs:{mapLoaded:"mapLoaded",mapMoveStart:"mapMoveStart",mapMoveEnd:"mapMoveEnd",mapResize:"mapResize",mapClicked:"mapClicked"},ngContentSelectors:o,decls:12,vars:0,consts:[["rel","preload","href","/assets/maps/leaflet.css","as","style","onload","this.onload=null;this.rel='stylesheet'"],["rel","stylesheet","href","/assets/maps/leaflet.css"],["rel","preload","href","/assets/maps/leaflet-gesture-handling.css","as","style","onload","this.onload=null;this.rel='stylesheet'"],["rel","stylesheet","href","/assets/maps/leaflet-gesture-handling.css"],["rel","preload","href","/assets/maps/custom-leaflet.50549b1eba10bab22f0614ef238eb03e518ca488c7d21c6cf51c72efa1c50e55.css","as","style","onload","this.onload=null;this.rel='stylesheet'"],["rel","stylesheet","href","/assets/maps/custom-leaflet.50549b1eba10bab22f0614ef238eb03e518ca488c7d21c6cf51c72efa1c50e55.css"],["id","mapDiv",1,"map"],["mapDiv",""]],template:function(e,t){1&e&&(a.Ac(),a.bc(0,"link",0),a.gc(1,"noscript"),a.bc(2,"link",1),a.fc(),a.bc(3,"link",2),a.gc(4,"noscript"),a.bc(5,"link",3),a.fc(),a.bc(6,"link",4),a.gc(7,"noscript"),a.bc(8,"link",5),a.fc(),a.bc(9,"div",6,7),a.zc(11))},styles:[".map[_ngcontent-%COMP%]{width:100%;height:100%;z-index:1}"]}),e})()},jV2t:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("5SZk"),a=r("8Y7J");let i=(()=>{class e{transform(e){return Object(n.a)(e,{green:"new-pin-green",yellow:"new-pin-yellow",orange:"new-pin-orange",red:"new-pin-red",purple:"new-pin-purple",maroon:"new-pin-maroon"})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=a.Zb({name:"aqiMapPinColorClass",type:e,pure:!0}),e})()},mANe:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("8Y7J"),a=r("SVse");let i=(()=>{class e{constructor(e){this.platformId=e,this.supportWebp=!0,Object(a.B)(this.platformId)&&this.check_webp_feature("lossless",(e,t)=>{this.supportWebp=t})}check_webp_feature(e,t){const r=new Image;r.onload=function(){t(e,r.width>0&&r.height>0)},r.onerror=function(){t(e,!1)},r.src="data:image/webp;base64,"+{lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"}[e]}}return e.\u0275fac=function(t){return new(t||e)(n.kc(n.J))},e.\u0275prov=n.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},mov8:function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"c",function(){return a}),r.d(t,"a",function(){return i}),r.d(t,"b",function(){return s}),r.d(t,"d",function(){return o});const n=4,a=15,i=7,s="map-pin-small";var o=function(e){return e[e.FRONTEND=0]="FRONTEND",e[e.BACKEND=1]="BACKEND",e}({})},wMn0:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(e){return e.FIRE="fire",e.CLUSTER="cluster",e.POLYGON="polygon",e.KEY_FIRE="keyWildFire",e}({})},xvjA:function(e,t,r){"use strict";r.d(t,"b",function(){return A}),r.d(t,"a",function(){return b});var n=r("SVse"),a=r("8Y7J"),i=r("AytR"),s=r("mov8"),o=r("wMn0"),l=r("mANe"),c=r("iInd"),u=r("mrSG"),p=r("W8+8"),d=r("IheW");let m=(()=>{class e{constructor(e){this.http=e,this.endpoint=Object(p.a)(),this.WIND_DATA_URL_DEV="https://staging-grib.airvisual.net/current-wind-surface-level-gfs-1.0.json",this.WIND_DATA_URL=`${this.endpoint}earth/current/current-wind-surface-level-gfs-1.0.json`}buildWindLayer(){return Object(u.a)(this,void 0,void 0,function*(){return this.windLayerPromise||(this.windLayerPromise=this._buildWindLayer()),yield this.windLayerPromise})}_buildWindLayer(){return Object(u.a)(this,void 0,void 0,function*(){const e=yield this.http.get(this.windDataUrl).toPromise();return new((yield Promise.all([r.e(25),r.e(153)]).then(r.bind(null,"/fYJ"))).VelocityLayer)({data:e,minVelocity:0,maxVelocity:30,colorScale:["#FFFFFF"],velocityScale:.01,particleZoomDensity:[{zoom:1,density:1},{zoom:4,density:.4},{zoom:6,density:.2},{zoom:8,density:.04}],displayValues:!1,particleAge:200,lineWidth:1})})}get windDataUrl(){return["dev","staging"].includes(i.a.environment)?this.WIND_DATA_URL_DEV:this.WIND_DATA_URL}}return e.\u0275fac=function(t){return new(t||e)(a.kc(d.b))},e.\u0275prov=a.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=r("AuMg"),f=r("KUxh"),A=function(e){return e[e.SMALL_TO_REGULAR=0]="SMALL_TO_REGULAR",e[e.REGULAR_TO_SMALL=1]="REGULAR_TO_SMALL",e[e.NONE=2]="NONE",e}({});let b=(()=>{class e{constructor(e,t,r,a,i,o){if(this.webpSupport=e,this.router=t,this.platformId=r,this.leafletVelocityLayerService=a,this.placesLayerService=i,this.leafletBuilder=o,this.getPinUpdate=(e,t)=>e<=s.e&&t>s.e?A.SMALL_TO_REGULAR:t<=s.e&&e>s.e?A.REGULAR_TO_SMALL:A.NONE,Object(n.B)(this.platformId)){const e=window.navigator.userAgent;this.isIE=e.indexOf("Trident")>=0}}generateLayer(e,t,r={},n=[],a=null){let i;switch(e){case"basic":i=this.createBaseLayer(t.L,Object.assign(Object.assign({},r),{zIndex:10}));break;case"toner":i=this.createTonerLayer(t.L,Object.assign(Object.assign({},r),{zIndex:10}));break;case"heatmap":i=this.createHeatmapLayer(t.L,Object.assign(Object.assign({},r),{zIndex:30}));break;case"overlay":i=this.createOverlayHeatmapLayer(t.L,Object.assign(Object.assign({},r),{zIndex:40}));break;case"population":i=this.createPopulationLayer(t.L,Object.assign(Object.assign({},r),{zIndex:35}));break;case"wind":this.createWindLayer(t,a);break;case"places":i=this.createPlaceLayer(t.L,n,a,t.mapObj);break;case"fires":i=this.createFireLayer(t.L,Object.assign(Object.assign({},r),{mapObj:t.mapObj}),n,a);break;case"customMarker":case"keyWildFire":i=this.createAlertsLayer(t.L,n,{mapObj:t.mapObj},a)}return i}createBaseLayer(e,t={}){let r=i.a.tileDomain;return(this.router.url.indexOf("/unep")>-1||this.router.url.indexOf("/osm-map")>-1)&&(r=`${i.a.tileDomain}/basic_un`),e.tileLayer.fallback(`${r}/{z}/{x}/{y}.${this.webpSupport.supportWebp?"webp":"png"}`,t)}createTonerLayer(e,t={}){return e.tileLayer.fallback(`${i.a.tileDomain}/underlay/{z}/{x}/{y}.${this.webpSupport.supportWebp?"webp":"png"}`,t)}createHeatmapLayer(e,t={}){var r;return e.tileLayer.fallback(`${"dev"===i.a.environment||"staging"===i.a.environment?i.a.tileDevDomain:`${i.a.tileDomain}/pm25_layer`}/{z}/{x}/{y}${(null===(r=e.Browser)||void 0===r?void 0:r.retina)?"@2x":""}.${this.webpSupport.supportWebp?"webp":"png"}`,Object.assign(Object.assign({},t),{opacity:.8,detectRetina:!0}))}createOverlayHeatmapLayer(e,t={}){return e.tileLayer.fallback("https://osm.airvisual.net/overlay/{z}/{x}/{y}@2x."+(this.webpSupport.supportWebp?"webp":"png"),t)}createWindLayer(e,t){this.isIE||this.leafletVelocityLayerService.buildWindLayer().then(e=>{t&&"function"==typeof t&&t(e)})}createPlaceLayer(e,t,r=null,n,a){return this.placesLayerService.createPlaceLayer(e,t,r,n,a)}createFireLayer(e,t={},r,n=null){let a=null;t.hasOwnProperty("mapObj")&&(a=t.mapObj.getZoom());const i=r.filter(e=>e.type!==o.a.KEY_FIRE),s=r.filter(e=>e.type===o.a.KEY_FIRE).map(e=>this.mapFireToAlert(e)),l=this.createFireMarkers(e,i,t,n,a),c=this.createFirePolygons(e,r,n),u=this._createCustomLayersHTML(e,s,n,a);return new e.featureGroup([...l,...c,...u])}mapFireToAlert(e){return{location:null==e?void 0:e.location,name:null==e?void 0:e.name,markerIconUrl:null==e?void 0:e.markerIconUrl,news:null==e?void 0:e.news,id:null==e?void 0:e.id,timestamp:e.timestamp,type:o.a.KEY_FIRE}}createAlertsLayer(e,t,r,n=null){const a=r.mapObj.getZoom();return new e.featureGroup(this._createCustomLayersHTML(e,t,n,a))}createFireMarkers(e,t,r,n=null,a=null){const i=[];for(const o in t){const l=t[o],c="assets/img/map-clusterer/";let u,p="assets/img/map-clusterer/ic-fire-map-cluster.svg",d=a<=s.e?[26,26]:[40,40],m="Fire cluster average intensity: ";if(!l.clustered)switch(p=c,l.intensity){case 1:p+="ic-fire-map-pin-low.svg",d=[24,24];break;case 2:p+="ic-fire-map-pin-medium.svg",d=[28,28];break;case 3:p+="ic-fire-map-pin-high.svg",d=[32,32]}l.clustered||(m=`Fire marker intensity: ${u}`);const h=new e.marker([l.location[1],l.location[0]],{icon:e.icon({iconUrl:p,iconSize:d}),zIndexOffset:1e3,keyboard:!r.hasOwnProperty("keyboard")||r.keyboard,alt:m}).on("click",e=>{n&&n(e,l)});i.push(h)}return i}createFirePolygons(e,t,r=null){return t.filter(e=>e.type===o.a.POLYGON).map(t=>this._createFirePolygonGeoJSON(e,t,r))}_createFirePolygonGeoJSON(e,t,r){return new e.geoJSON(t.polygon,{style:{color:"red"}}).on("click",e=>{r&&r(e,t)})}createPopulationLayer(e,t={}){return t=Object.assign(t,{param:function(e){return`${e.z}/${e.x}/${(1<<e.z)-e.y-1}`},opacity:.4}),e.tileLayer.fallback(`${i.a.tileDomain}/population/{param}.png`,t)}_createCustomLayersHTML(e,t,r,n){const a=[];for(const i of t){const t=this.leafletBuilder.createDivIcon(e,{iconSize:[0,0],html:this._getCustomHTML(i.markerIconUrl,i.name,n)}),s=new e.marker([null==i?void 0:i.location[1],null==i?void 0:i.location[0]],{icon:t,zIndexOffset:1e3}).on("click",e=>{r&&r(e,i)}).on("add",e=>{e.target.getElement().classList.add("custom-marker")});a.push(s)}return a}_getCustomHTML(e,t,r){return`<div class="leaflet-custom-marker-wrapper">\n      <img class="marker-icon-url" width="16" height="16" src="${e}" alt="${e}"/>\n        <span class="marker-icon-name ${r>=s.a?"block":"none"}">${t}</span>\n      </div>`}}return e.\u0275fac=function(t){return new(t||e)(a.kc(l.a),a.kc(c.g),a.kc(a.J),a.kc(m),a.kc(h.a),a.kc(f.a))},e.\u0275prov=a.Wb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);